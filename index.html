<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>이진수 카드놀이 (16-8-4-2-1)</title>
  <style>
    :root {
      --card-w: 140px;
      --card-h: 190px;
      --radius: 16px;
      --gap: 16px;
      --back-color: #3a7bd5; /* 카드 뒷면 색 */
      --front-bg: #ffffff;
      --table: #0f172a;      /* 배경 */
      --dot-size: 16px;
      --shadow: 0 10px 20px rgba(0,0,0,0.15);
      --accent: #10b981;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 24px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Apple SD Gothic Neo, "맑은 고딕", sans-serif;
      background: radial-gradient(1000px 600px at 20% -10%, #1e293b 0, #0f172a 55%) fixed;
      color: #e5e7eb;
    }

    .wrap {
      max-width: 980px;
      margin: 0 auto;
    }

    header {
      display: flex; align-items: end; justify-content: space-between;
      gap: 16px; margin-bottom: 18px;
    }
    h1 {
      font-size: clamp(18px, 2.2vw, 26px);
      margin: 0;
    }
    .hint {
      opacity: .8; font-size: 14px; line-height: 1.4;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(5, minmax(var(--card-w), 1fr));
      gap: var(--gap);
      justify-items: center;
      align-items: center;
      margin: 8px 0 22px;
    }

    /* 카드 컨테이너 (3D 뒤집기) */
    .card {
      width: var(--card-w);
      height: var(--card-h);
      perspective: 1000px;
      cursor: pointer;
      position: relative;
    }
    .card:focus-visible { outline: 2px solid #fff; outline-offset: 4px; border-radius: var(--radius); }

    .flip {
      width: 100%; height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform .5s cubic-bezier(.2,.7,.2,1);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .card.flipped .flip { transform: rotateY(180deg); }

    .face {
      position: absolute; inset: 0;
      border-radius: var(--radius);
      backface-visibility: hidden;
      display: grid; place-items: center;
      padding: 14px;
    }

    /* 앞면(점) */
    .front {
      background: var(--front-bg);
      color: #0f172a;
      transform: rotateY(180deg);
      border: 2px solid #e2e8f0;
    }

    /* 뒷면(무늬 없음, 색만) */
    .back {
      background: linear-gradient(135deg, var(--back-color), #174ea6);
      border: 2px solid rgba(255,255,255,.18);
    }

    /* 점 그리드 */
    .dots {
      display: grid;
      gap: 10px;
      width: 88%;
      height: 72%;
      align-content: center;
      justify-content: center;
    }
    .dot {
      width: var(--dot-size);
      height: var(--dot-size);
      border-radius: 50%;
      background: #111827;
      filter: drop-shadow(0 1px 0 rgba(0,0,0,.15));
    }

    /* 카드 하단 값 뱃지 */
    .badge {
      position: absolute;
      bottom: 10px; right: 12px;
      padding: 4px 10px;
      background: #11182710;
      backdrop-filter: blur(4px);
      border-radius: 999px;
      border: 1px solid #e5e7eb55;
      color: #111827;
      font-weight: 700;
      font-size: 14px;
    }

    /* 총합 표시 */
    .sum {
      display: flex; align-items: baseline; gap: 12px;
      background: #0b1220;
      padding: 16px 18px;
      border: 1px solid #1f2937;
      border-radius: 14px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
    }
    .sum .label { font-size: 16px; opacity: .85; }
    .sum .value {
      font-variant-numeric: tabular-nums;
      font-size: clamp(26px, 6vw, 40px);
      font-weight: 800;
      color: var(--accent);
      text-shadow: 0 0 16px #10b98122;
      letter-spacing: .5px;
      min-width: 1ch;
    }

    /* 반응형 */
    @media (max-width: 860px) {
      :root { --card-w: 120px; --card-h: 170px; }
      .board { grid-template-columns: repeat(5, minmax(var(--card-w), 1fr)); }
    }
    @media (max-width: 640px) {
      :root { --card-w: 94px; --card-h: 140px; --dot-size: 12px; }
      .board { gap: 12px; }
    }
    @media (max-width: 520px) {
      .board { grid-template-columns: repeat(3, minmax(var(--card-w), 1fr)); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>이진수 카드놀이 — 16 · 8 · 4 · 2 · 1</h1>
      <div class="hint">
        카드를 클릭(또는 Space/Enter)하여 뒤집어요. 앞면이 보이는 카드의 값 합계를 아래에 표시합니다.
      </div>
    </header>

    <main>
      <section class="board" id="board" aria-label="이진수 카드 보드">
        <!-- JS가 카드 5장을 생성합니다 -->
      </section>

      <section class="sum" aria-live="polite">
        <div class="label">합계</div>
        <div class="value" id="sumValue">0</div>
      </section>
    </main>
  </div>

  <script>
    /**
     * 카드 스펙: 왼쪽 → 오른쪽 순서로 16, 8, 4, 2, 1
     * 초기 상태는 모두 '뒤집힘(뒷면 보임)' = false
     */
    const CARD_VALUES = [16, 8, 4, 2, 1];

    const board = document.getElementById('board');
    const sumValue = document.getElementById('sumValue');

    /**
     * 점(도트) 그리드를 만들기
     * - 점 개수만큼 원 모양 div를 만들고,
     * - 적당한 정사각형에 가깝게 그리드 열 개수를 계산해 적용
     */
    function createDotsGrid(dotCount) {
      const wrap = document.createElement('div');
      wrap.className = 'dots';

      // 정사각형에 가까운 열 수(ceil(sqrt(n)))로 자동 배치
      const cols = Math.ceil(Math.sqrt(dotCount));
      wrap.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

      for (let i = 0; i < dotCount; i++) {
        const d = document.createElement('div');
        d.className = 'dot';
        wrap.appendChild(d);
      }
      return wrap;
    }

    /**
     * 카드 DOM 생성
     */
    function createCard(value, index) {
      const card = document.createElement('button');
      card.className = 'card';
      card.setAttribute('type', 'button');
      card.setAttribute('data-value', String(value));
      card.setAttribute('aria-pressed', 'false');
      card.setAttribute('aria-label', `${value} 카드 (현재: 뒷면)`);

      const flip = document.createElement('div');
      flip.className = 'flip';

      // 뒷면 (색만, 무늬 없음)
      const back = document.createElement('div');
      back.className = 'face back';

      // 앞면 (점 + 값 뱃지)
      const front = document.createElement('div');
      front.className = 'face front';

      const dots = createDotsGrid(value);
      const badge = document.createElement('div');
      badge.className = 'badge';
      badge.textContent = value;

      front.appendChild(dots);
      front.appendChild(badge);

      flip.appendChild(front);
      flip.appendChild(back);
      card.appendChild(flip);

      // 클릭/키보드 토글
      card.addEventListener('click', () => toggleCard(card));
      card.addEventListener('keydown', (e) => {
        if (e.key === ' ' || e.key === 'Enter') {
          e.preventDefault();
          toggleCard(card);
        }
      });

      return card;
    }

    function toggleCard(cardEl) {
      const nowFlipped = !cardEl.classList.contains('flipped');
      cardEl.classList.toggle('flipped', nowFlipped);
      cardEl.setAttribute('aria-pressed', String(nowFlipped));
      const v = cardEl.getAttribute('data-value');
      cardEl.setAttribute('aria-label', `${v} 카드 (현재: ${nowFlipped ? '앞면' : '뒷면'})`);
      recalcSum();
    }

    function recalcSum() {
      const cards = [...document.querySelectorAll('.card')];
      const sum = cards
        .filter(c => c.classList.contains('flipped'))
        .map(c => Number(c.getAttribute('data-value')))
        .reduce((a, b) => a + b, 0);
      sumValue.textContent = String(sum);
    }

    // 초기 렌더
    function init() {
      CARD_VALUES.forEach((v, i) => {
        const c = createCard(v, i);
        board.appendChild(c);
      });
      recalcSum();
    }

    init();
  </script>
</body>
</html>
